<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aventuras em Português</title>
  <style>
    body {
      margin: 0;
      font-family: 'Comic Sans MS', system-ui, sans-serif;
      background: #fdfdc9;
      color: #0f0e0e;
      text-align: center;
    }
    header {
      background: #c69fd5;
      padding: 14px;
      color: #fff;
      font-size: 1.5rem;
      font-weight: bold;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 24px;
      box-shadow: 0 8px 24px rgba(0,0,0,.1);
    }
    .question {
      font-size: 1.3rem;
      margin: 20px 0;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin: 20px 0;
    }
    .option {
      background: #ffe49e;
      padding: 12px 20px;
      border-radius: 14px;
      cursor: grab;
      font-weight: bold;
      user-select: none;
      box-shadow: 0 4px 10px rgba(0,0,0,.1);
    }
    .option[draggable="false"]{ cursor: default; opacity: .6 }
    .dropzone {
      min-height: 50px;
      padding: 10px;
      border: 2px dashed #c69fd5;
      border-radius: 14px;
      margin: 10px 0;
      display: inline-block;
      min-width: 80px;
    }
    .correct { background: #c8f4ea !important; }
    .wrong { background: #ffcdd2 !important; }
    #feedback {
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 15px;
    }
    button {
      background: #c69fd5;
      color: #fff;
      border: none;
      border-radius: 18px;
      padding: 12px 24px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px;
    }
    #menu button {
      background: #ffe49e;
      color: #0f0e0e;
    }
    #hearts {
      margin: 10px;
      font-size: 1.5rem;
      color: red
    }
  

    /* Game Over overlay */
    #gameOver {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.6);
      visibility: hidden;
      opacity: 0;
      transition: opacity .3s, visibility .3s;
      z-index: 9999;
    }
    #gameOver.show { visibility: visible; opacity: 1; }
    .gameover-card {
      background: linear-gradient(135deg,#ffffff,#ffffff);
      color: #ff0000;
      padding: 36px 28px;
      border-radius: 20px;
      width: min(520px, 90%);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      text-align: center;
      transform: translateY(-10px);
      animation: pop .45s ease-out;
    }
    .gameover-card h1 {
      margin: 0 0 6px 0;
      font-size: 2.8rem;
      letter-spacing: 2px;
    }
    .gameover-card p { margin: 6px 0 18px 0; font-size: 1.1rem; color: #000000 }
    .gameover-actions { display:flex; gap:12px; justify-content:center; margin-top: 12px }
    .ghost-btn{ background: transparent; border: 2px solid rgba(255,255,255,.15); padding: 10px 18px; border-radius: 12px; color: #fff }

    @keyframes pop{ from { transform: translateY(-24px) scale(.98); opacity: 0 } to { transform: translateY(0) scale(1); opacity:1 } }

    /* small responsive tweaks */
    @media (max-width:420px){ .gameover-card h1 { font-size: 2rem } }
  </style>
</head>
<body>
  <header> Aventuras em Português </header>
  <div class="container">
    <div id="menu">
      <h2>Escolha a dificuldade</h2>
      <button onclick="escolherNivel('facil')">Fácil</button>
      <button onclick="escolherNivel('medio')">Médio</button>
      <button onclick="escolherNivel('dificil')">Difícil</button>
    </div>

    <div id="game" style="display:none;">
      <div id="hearts">❤️❤️❤️</div>
      <div class="question" id="question"></div>
      <p id="sentence"></p>

      <div class="options" id="options"></div>

      <div id="feedback"></div>
      <button onclick="reiniciar()">Reiniciar</button>
      <button onclick="proximaFase()">Próxima fase</button>
       <button onclick="window.location.href='play_joy.html'" class="btn btn-primary">Sair</button>
    </div>
  </div>

  <!-- Game Over overlay -->
  <div id="gameOver" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gameover-card" role="document">
      <h1>GAME OVER !</h1>
      <p> Você ficou sem corações. Não desista — tente novamente e vença as fases!</p>
      <div class="gameover-actions">
        <button onclick="reiniciarDoGameOver()">Jogar novamente</button>
        <button onclick="voltarMenuDoGameOver()">Voltar ao menu</button>
<!--        <button class="ghost-btn" onclick="voltarMenuDoGameOver()">Voltar ao menu</button>-->
      </div>
    </div>
  </div>

  <script>
    const fasesPorNivel = {
      facil: [
        { frase: "O gato está <span class='dropzone' id='drop'></span> do sofá.", correta: "em cima", opcoes: ["em cima", "banana", "verde"] },
        { frase: "A menina gosta de <span class='dropzone' id='drop'></span> livros.", correta: "ler", opcoes: ["correr", "ler", "chuva"] },
        { frase: "Hoje o céu está <span class='dropzone' id='drop'></span>.", correta: "azul", opcoes: ["azul", "cachorro", "correr"] },
        { frase: "O bolo é muito <span class='dropzone' id='drop'></span>.", correta: "gostoso", opcoes: ["rápido", "gostoso", "carro"] },
        { frase: "Pedro foi para a <span class='dropzone' id='drop'></span> estudar.", correta: "escola", opcoes: ["árvore", "escola", "chão"] },
        { frase: "A bola rolou para <span class='dropzone' id='drop'></span> da mesa.", correta: "baixo", opcoes: ["baixo", "flor", "bonito"] }
      ],
      medio: [
        { frase: "O cachorro <span class='dropzone' id='drop'></span> quando vê o dono.", correta: "late", opcoes: ["late", "corre", "verde"] },
        { frase: "O livro está <span class='dropzone' id='drop'></span> da mochila.", correta: "dentro", opcoes: ["dentro", "rápido", "cachorro"] },
        { frase: "Maria comprou um vestido <span class='dropzone' id='drop'></span>.", correta: "vermelho", opcoes: ["vermelho", "sorriso", "correr"] },
        { frase: "Ele gosta de <span class='dropzone' id='drop'></span> futebol.", correta: "jogar", opcoes: ["jogar", "comer", "bonito"] },
        { frase: "A casa é <span class='dropzone' id='drop'></span>.", correta: "grande", opcoes: ["grande", "chuva", "feliz"] },
        { frase: "O sol nasce no <span class='dropzone' id='drop'></span>.", correta: "leste", opcoes: ["leste", "azul", "árvore"] }
      ],
      dificil: [
        { frase: "A borboleta pousou <span class='dropzone' id='drop'></span> da flor.", correta: "sobre", opcoes: ["sobre", "bonito", "rápido"] },
        { frase: "Ele respondeu a pergunta com muita <span class='dropzone' id='drop'></span>.", correta: "sabedoria", opcoes: ["sabedoria", "futebol", "mesa"] },
        { frase: "A música estava tão <span class='dropzone' id='drop'></span> que todos dançaram.", correta: "animada", opcoes: ["animada", "carro", "chuva"] },
        { frase: "Os pássaros voam em <span class='dropzone' id='drop'></span>.", correta: "bando", opcoes: ["bando", "livro", "grande"] },
        { frase: "A professora explicou a lição com <span class='dropzone' id='drop'></span>.", correta: "clareza", opcoes: ["clareza", "correr", "verde"] },
        { frase: "A invenção trouxe grande <span class='dropzone' id='drop'></span> para a ciência.", correta: "avanço", opcoes: ["avanço", "erro", "chuva"] },
        { frase: "O atleta venceu a corrida com <span class='dropzone' id='drop'></span>.", correta: "esforço", opcoes: ["esforço", "sono", "cansaço"] },
        { frase: "O poeta escreveu versos cheios de <span class='dropzone' id='drop'></span>.", correta: "emoção", opcoes: ["emoção", "chuva", "livro"] },
        { frase: "A criança ficou <span class='dropzone' id='drop'></span> ao ganhar o presente.", correta: "feliz", opcoes: ["feliz", "triste", "lento"] },
        { frase: "A floresta era densa e cheia de <span class='dropzone' id='drop'></span>.", correta: "mistérios", opcoes: ["mistérios", "carros", "praias"] },
        { frase: "A invenção trouxe grande <span class='dropzone' id='drop'></span> para a ciência.", correta: "avanço", opcoes: ["avanço", "erro", "chuva"] },
        { frase: "O atleta venceu a corrida com <span class='dropzone' id='drop'></span>.", correta: "esforço", opcoes: ["esforço", "sono", "cansaço"] }
      ]
    };

    let nivel = null;
    let fases = [];
    let faseAtual = 0;
    let coracoes = 3;
    let isGameOver = false;

    const menu = document.getElementById('menu');
    const game = document.getElementById('game');
    const question = document.getElementById('question');
    const sentence = document.getElementById('sentence');
    const optionsDiv = document.getElementById('options');
    const feedback = document.getElementById('feedback');
    const heartsDiv = document.getElementById('hearts');
    const gameOverOverlay = document.getElementById('gameOver');

    function atualizarCoracoes(){
      heartsDiv.textContent = '❤️'.repeat(Math.max(0, coracoes));
      if(coracoes <= 0 && !isGameOver){
        isGameOver = true;
        mostrarGameOver();
      }
    }

    function mostrarGameOver(){
      feedback.textContent = '';
      // desativa opções
      optionsDiv.querySelectorAll('.option').forEach(opt=>{
        opt.setAttribute('draggable','false');
      });
      // mostra overlay
      gameOverOverlay.classList.add('show');
      gameOverOverlay.setAttribute('aria-hidden','false');
    }

    function esconderGameOver(){
      gameOverOverlay.classList.remove('show');
      gameOverOverlay.setAttribute('aria-hidden','true');
      isGameOver = false;
    }

    function escolherNivel(n){
      nivel = n;
      fases = fasesPorNivel[nivel];
      faseAtual = 0;
      coracoes = 3;
      atualizarCoracoes();
      menu.style.display = 'none';
      game.style.display = 'block';
      esconderGameOver();
      carregarFase();
    }

    function carregarFase(){
      const fase = fases[faseAtual];
      question.textContent = `${nivel.toUpperCase()} - Fase ${faseAtual+1} de ${fases.length}: Complete a frase.`;
      sentence.innerHTML = fase.frase;
      optionsDiv.innerHTML = '';
      feedback.textContent = '';

      fase.opcoes.forEach(opt => {
        const div = document.createElement('div');
        div.textContent = opt;
        div.className = 'option';
        div.draggable = true;
        div.addEventListener('dragstart', e => {
          if(isGameOver) { e.preventDefault(); return; }
          e.dataTransfer.setData('text', opt);
        });
        optionsDiv.appendChild(div);
      });

      const drop = document.getElementById('drop');
      // remove possíveis listeners anteriores criando clone seguro
      const newDrop = drop.cloneNode(true);
      drop.parentNode.replaceChild(newDrop, drop);

      newDrop.addEventListener('dragover', e => e.preventDefault());
      newDrop.addEventListener('drop', e => {
        e.preventDefault();
        if(isGameOver) return;
        const word = e.dataTransfer.getData('text');
        newDrop.textContent = word;

        if(word === fase.correta){
          newDrop.classList.add('correct');
          feedback.textContent = ' Muito bem! Você acertou!';
          feedback.style.color = '#147d6f';
        } else {
          newDrop.classList.add('wrong');
          feedback.textContent = ' Ops! Essa não é a palavra certa.';
          feedback.style.color = '#b00020';
          coracoes--;
          atualizarCoracoes();
        }
      });
    }

    function proximaFase(){
      if(isGameOver) return;
      if(faseAtual < fases.length - 1){
        faseAtual++;
        carregarFase();
      } else {
        feedback.textContent = ' Parabéns! Você completou todas as fases!';
        feedback.style.color = '#147d6f';
      }
    }

    function reiniciar(){
      faseAtual = 0;
      coracoes = 3;
      atualizarCoracoes();
      esconderGameOver();
      carregarFase();
    }

    function reiniciarDoGameOver(){
      reiniciar();
    }

    function voltarMenu(){
      game.style.display = 'none';
      menu.style.display = 'block';
      esconderGameOver();
    }
    function voltarMenuDoGameOver(){
      voltarMenu();
    }
  </script>
</body>
</html>
